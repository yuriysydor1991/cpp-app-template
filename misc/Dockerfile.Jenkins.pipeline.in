FROM jenkins/jenkins:lts

USER root 

RUN apt update
RUN apt install -y libstdc++6 build-essential git cmake g++
RUN apt install -y clang-format
RUN apt install -y cppcheck
RUN apt install -y valgrind
RUN apt install -y flatpak
RUN apt install -y clang-tidy

ARG srcD=/usr/src
ARG BUILDDIR=$srcD/${PROJECT_BINARY_NAME}-build-docker-singlerun
ARG TMPPDIR=/tmp/${PROJECT_BINARY_NAME}
ARG PRJDIR=$srcD/${PROJECT_BINARY_NAME}

RUN --mount=from=project,target=$TMPPDIR cp -R $TMPPDIR $PRJDIR

CMD ["jenkins.sh"]

